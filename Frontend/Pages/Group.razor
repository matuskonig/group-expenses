@page "/Group/{groupId:guid}"
@using Frontend.Providers
@using Entities.GroupDto
@using Frontend.Components.Groups
@using Frontend.Services
@using Microsoft.AspNetCore.Authorization
@inject UserApiService _userApiService
@attribute [Authorize]
@{
    var foundGroup = GetFoundGroup();
}
@if (foundGroup == null)
{
    return;
}

<GroupTitle Group="@foundGroup"/>
<GroupUsers Group="@foundGroup"/>
<GroupSettlement Group="@foundGroup"/>
<GroupPayments Group="@foundGroup"/>


@code {

    [Parameter]
    public Guid GroupId { get; set; }

    [CascadingParameter]
    public GroupServiceProvider GroupServiceProvider { get; set; }

    private SinglePurposeUserGroupDto GetFoundGroup() =>
        GroupServiceProvider.UserGroups.FirstOrDefault(group => group.Id == GroupId);

    protected override async Task OnInitializedAsync()
    {
        await _userApiService.LoadCurrent();
    }

}